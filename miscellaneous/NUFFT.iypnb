{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "worth-bench",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "from math import log10, ceil, floor\n",
    "from functools import partial\n",
    "from itertools import product\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "pressed-stopping",
   "metadata": {},
   "source": [
    "## 1. Spreading"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "conceptual-consequence",
   "metadata": {},
   "outputs": [],
   "source": [
    "def compute_w(epsilon):\n",
    "    return ceil(log10(1/epsilon)) + 1\n",
    "    \n",
    "def compute_beta(epsilon):\n",
    "    return 2.3 * compute_w(epsilon)\n",
    "\n",
    "def fine_grid_size(nonuniform_grid_size, w, upsampling_factor=2):\n",
    "    # TODO fix\n",
    "    sz = np.ceil(np.maximum(upsampling_factor * nonuniform_grid_size, 2*w*np.ones_like(nonuniform_grid_size)))\n",
    "    return sz.astype(int)\n",
    "\n",
    "def fine_grid_spacing(n):\n",
    "    return 2*np.pi / n\n",
    "\n",
    "def kernel(z, beta):\n",
    "    return np.exp(beta * (np.sqrt(1 - z*z) - 1)) if abs(z) <= 1 else 0\n",
    "\n",
    "def compute_alpha(w, n):\n",
    "    return w * np.pi / n\n",
    "\n",
    "# grid of elements of Z (signed integers) such that the kernel function is not zero\n",
    "# on xi - 2 pi mi, i = 0,...,d where d is the number of dimensions\n",
    "def m_grid(point, alpha):\n",
    "    xi = point[0]\n",
    "    alpha_i = alpha[0]\n",
    "    return tuple(\n",
    "        tuple(range(ceil((xi - alpha_i)/(2*np.pi)), floor((xi + alpha_i)/(2*np.pi)) + 1)) \n",
    "            for xi, alpha_i in zip(point, alpha)\n",
    "    ) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "painful-journalism",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "w = 11, beta = 25.299999999999997\n",
      "N (non-uniform grid) = [11 16], n (uniform grid) = [22 32]\n",
      "h (fine grid spacing) = [0.28559933 0.19634954]\n",
      "alpha = [1.57079633 1.07992247]\n"
     ]
    }
   ],
   "source": [
    "# all the points in R^d where we evaluate the function\n",
    "pts = np.reshape(np.meshgrid([0.1 * i for i in range(11)], [0.1 * (i*i) for i in range(16)]),(2,-1)).T\n",
    "N = np.array([len(np.unique(pts[:,i])) for i in range(pts.shape[1])])\n",
    "\n",
    "epsilon = 1.e-10\n",
    "\n",
    "w = compute_w(epsilon)\n",
    "beta = compute_beta(epsilon)\n",
    "n = fine_grid_size(N, w)\n",
    "h = fine_grid_spacing(n)\n",
    "krn = partial(kernel, beta=beta)\n",
    "alpha = compute_alpha(w,n)\n",
    "\n",
    "print('w = {}, beta = {}'.format(w, beta))\n",
    "print('N (non-uniform grid) = {}, n (uniform grid) = {}'.format(N, n))\n",
    "print('h (fine grid spacing) = {}'.format(h))\n",
    "print('alpha = {}'.format(alpha))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "passive-marine",
   "metadata": {},
   "outputs": [],
   "source": [
    "def psi(x, alpha, kernel):\n",
    "    krn = np.frompyfunc(kernel, 1, 1)\n",
    "    return np.prod(krn(np.divide(x, alpha)))\n",
    "\n",
    "# takes a point xi in input and the set of integers that make the\n",
    "# |(xi - 2 pi m_i) / alpha_i| <= 1\n",
    "# prt_psi accepts only a vector of coords\n",
    "def psi_per(xi, prt_psi, alpha, verbose=False):\n",
    "    # apply psi to a given combination of m1,..,md\n",
    "    compute_psi = lambda ms: prt_psi(*(xi - 2*np.pi*ms))\n",
    "    \n",
    "    mi = m_grid(xi, alpha)\n",
    "    # assert all(ms for ms in mi)\n",
    "    if not all(mi):\n",
    "        if verbose:\n",
    "            print('[WARNING] no m found for x={}'.format(xi))\n",
    "        return 0\n",
    "    \n",
    "    return sum(map(compute_psi, map(np.array, product(mi))))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "statewide-illinois",
   "metadata": {},
   "outputs": [],
   "source": [
    "# l is a vector of fine grid indexes\n",
    "# f is the vector of values of the function\n",
    "#    in all the points (i.e. rows) of the matrix x\n",
    "# x is a matrix whose rows are coordinates in which the function\n",
    "#    is evaluated\n",
    "# h is the spacing in the uniform grid\n",
    "def compute_b(l, f, points, h, prt_psi_per):    \n",
    "    sm = 0\n",
    "    lh = np.multiply(l, h)\n",
    "    \n",
    "    assert len(f) == len(points)\n",
    "    for fi, xi in zip(f,points):\n",
    "        sm += fi * prt_psi_per(lh - xi)\n",
    "    return sm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "precise-retreat",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2.6426708313214515"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "prt_psi = partial(psi, alpha=alpha, kernel=partial(kernel, beta=beta))\n",
    "\n",
    "f = np.array(list(map(lambda v: np.sin(v[0]*np.pi/12) * np.cos(v[1]*np.pi/3), pts)))\n",
    "f_grid = f.reshape(N, order='F')\n",
    "plt.pcolormesh(f_grid)\n",
    "\n",
    "l = np.array([1,1])\n",
    "prt_psi_per = partial(psi_per, prt_psi=prt_psi, alpha=alpha)\n",
    "\n",
    "compute_b(l, f=f, points=pts, h=h, prt_psi_per=prt_psi_per)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "configured-chicken",
   "metadata": {},
   "source": [
    "## 2. FFT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cooperative-offering",
   "metadata": {},
   "outputs": [],
   "source": [
    "prt_compute_b = partial(compute_b, f=f, points=pts, h=h, prt_psi_per=prt_psi_per)\n",
    "b = np.zeros(n, dtype=float)\n",
    "\n",
    "# TODO improve performance\n",
    "for cmb in map(tuple, product(*(range(ni) for ni in n))):\n",
    "    b[cmb] = prt_compute_b(cmb)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "incoming-vermont",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.pcolormesh(b)\n",
    "plt.colorbar();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "published-costume",
   "metadata": {},
   "outputs": [],
   "source": [
    "fftb = np.fft.fftn(b)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "general-threshold",
   "metadata": {},
   "source": [
    "## 3. Deconvolution"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "romance-proposition",
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO\n",
    "def kernel_fourier_transform(w):\n",
    "    return 1\n",
    "\n",
    "# translation is a vector containing the original shape of the FFT\n",
    "# which is used to translate back the indexes\n",
    "def correction_factor(frq_indexes, translation, w, kernel, alpha):\n",
    "    vec_krn = np.vectorize(kernel_fourier_transform)\n",
    "    frq_indexes -= translation / 2\n",
    "    return (2/w)*(2/w) / (np.prod(vec_krn(np.multiply(alpha, frq_indexes))))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "occasional-teens",
   "metadata": {},
   "outputs": [],
   "source": [
    "prt_correction_factor = partial(correction_factor, translation=np.array(fftb.shape), w=w, \n",
    "                                kernel=partial(kernel, beta=beta), alpha=alpha)\n",
    "\n",
    "N_frq = np.array([10,6])\n",
    "p = np.zeros(N_frq, dtype=float)\n",
    "\n",
    "for cmb in product(*(range(ni) for ni in N_frq)):\n",
    "    p[cmb] = prt_correction_factor(cmb)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "fewer-richards",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1440x360 with 4 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# assume this is all always even\n",
    "def extract_center(shape, n):\n",
    "    return tuple(slice(shape[i]//2 - n[i]//2, shape[i]//2 + n[i]//2) for i in range(len(n)))\n",
    "\n",
    "cropped_fftb = fftb[extract_center(fftb.shape, N_frq)]\n",
    "#ftilde = np.multiply(p, cropped_fftb)\n",
    "ftilde = cropped_fftb\n",
    "\n",
    "plt.figure(figsize=(20,5))\n",
    "plt.subplot(1,2,1)\n",
    "plt.pcolormesh(ftilde.real)\n",
    "plt.colorbar()\n",
    "plt.title('Real')\n",
    "plt.subplot(1,2,2)\n",
    "plt.pcolormesh(ftilde.imag)\n",
    "plt.colorbar()\n",
    "plt.title('Imag')\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
